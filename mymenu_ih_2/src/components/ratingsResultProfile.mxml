<?xml version="1.0" encoding="utf-8"?>
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 
				dataChange="dchange(event)"
				creationComplete="init(event)"
				xmlns:s="library://ns.adobe.com/flex/spark" >
	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			
			import spark.core.ContentCache;
			static public const s_imageCache:ContentCache = new ContentCache();
			protected function init(event:FlexEvent):void
			{
				if (data.totallikecount == null){
					data.totallikecount = "0";
				}
				
				if ((data.ratingdescription == null)||(data.ratingdescription.length < 4)){
					data.ratingdescription = "";	
				}
				var ratingstring:String = "";
				var ratingnumber:Number = 0;		
				ratingstring = data.rating.toString();
				ratingnumber = Number(data.rating);
				if (ratingnumber == 0){
					ratinglabel.text = "-";
				}
				
				if (ratingnumber >= 10){
					ratingnumber = 10;
					ratinglabel.text = "10";
				}
				
				if (data.ratingdescription.length == 0){
					likecont.height = 0;
				}
				else {
					likecont.percentHeight = 100;
				}
				
				var datedata:String = data.ratingdate;
				var year:String = datedata.substring(0,datedata.indexOf("-"));
				datedata = datedata.substring(datedata.indexOf("-")+1,datedata.length);
				var month:String = datedata.substring(0,datedata.indexOf("-"));
				datedata = datedata.substring(datedata.indexOf("-")+1,datedata.length);
				var day:String = datedata.substring(0,datedata.indexOf(" "));
				datedata = datedata.substring(datedata.indexOf(" ")+1,datedata.length);
				var time:String = datedata;
				var fullmonth:String = getMonth(Number(month));
				var stop:String = "";
				datetext.text = fullmonth+" "+day+", "+year+" at "+time;

			}
			public function getMonth(u:Number):String{
				switch (u){
					case 1 :
						return "January";
						break;
					case 2 :
						return "February";
						break;
					case 3 :
						return "March";
						break;
					case 4 :
						return "April";
						break;
					case 5 :
						return "May";
						break;
					case 6 :
						return "June";
						break;
					case 7 :
						return "July";
						break;
					case 8 :
						return "August";
						break;
					case 9 :
						return "September";
						break;
					case 10 :
						return "October";
						break;
					case 11 :
						return "November";
						break;
					case 12 :
						return "December";
						break;
				}
				return "";
			}
			public function dchange(event:FlexEvent):void
			{
				try{
					
					if (data.totallikecount == null){
						data.totallikecount = "0";
					}
					
					if ((data.ratingdescription == null)||(data.ratingdescription.length < 4)){
						data.ratingdescription = "";	
					}
					
					
					var ratingstring:String = "";
					var ratingnumber:Number = 0;
					ratingstring = data.rating.toString();
					ratingnumber = Number(data.rating);
					
					if (ratingnumber == 0){
						ratinglabel.text = "-";
					}
					
					if (ratingnumber >= 10){
						ratingnumber = 10;
						ratinglabel.text = "10";
					}
					
					if (data.ratingdescription.length == 0){
						likecont.height = 0;
					}
					else {
						likecont.percentHeight = 100;
					}
					
					var datedata:String = data.ratingdate;
					var year:String = datedata.substring(0,datedata.indexOf("-"));
					datedata = datedata.substring(datedata.indexOf("-")+1,datedata.length);
					var month:String = datedata.substring(0,datedata.indexOf("-"));
					datedata = datedata.substring(datedata.indexOf("-")+1,datedata.length);
					var day:String = datedata.substring(0,datedata.indexOf(" "));
					datedata = datedata.substring(datedata.indexOf(" ")+1,datedata.length);
					var time:String = datedata;
					var fullmonth:String = getMonth(Number(month));
					var stop:String = "";
					datetext.text = fullmonth+" "+day+", "+year+" at "+time;
				}
				catch(e:Error){
					var stop:String = "";
				}	
			}
		]]>
	</fx:Script>
<s:Group width="{this.width}"  mouseEnabled="false"   id="megacont"  >
	<s:VGroup width="100%" height="100%" 
			  paddingTop="30" paddingRight="30"
			  paddingBottom="30" paddingLeft="30">
		<s:HGroup width="100%" verticalAlign="middle">
			<s:Label  text="{data.firstname.charAt(0).toUpperCase()+data.firstname.substring(1,data.firstname.length)}"
					  color="#4d4d4d"  fontWeight="bold" styleName="textsize1" verticalAlign="middle"/>
			<s:Image source="assets/trirating.png"/>
			<s:Label  text="{data.menuname}" width="100%" maxDisplayedLines="1"
					  color="#4d4d4d"  fontWeight="bold" styleName="textsize1" verticalAlign="middle"/>
		</s:HGroup>
		<s:HGroup width="100%" verticalAlign="top">
			<s:Label id="ratinglabel"  text="{data.rating}"  color="#43c7ae"  fontWeight="bold"
					 styleName="textsize0" verticalAlign="middle"/>
			<s:Group width="100%" >
				<s:Label width="100%" visible="{data.ratingdescription.length != 0}"    maxDisplayedLines="3"  text="{data.ratingdescription}" 
						 color="#4d4d4d"  fontWeight="normal" styleName="textsize0" verticalAlign="middle"/>
				<s:HGroup verticalAlign="middle" visible="{data.ratingdescription.length == 0}" >
					<s:Image source="assets/triratinggreen.png"/>
					<s:Label   text="{data.totallikecount}"  color="#43c7ae"  fontWeight="bold"
							   styleName="textsize0" verticalAlign="middle"/>
				</s:HGroup>
			</s:Group>
			
		</s:HGroup>
		<s:HGroup verticalAlign="middle" id="likecont"  visible="{data.ratingdescription.length != 0}">
			<s:Image source="assets/triratinggreen.png"/>
			<s:Label   text="{data.totallikecount}"  color="#43c7ae"  fontWeight="bold"
					   styleName="textsize0" verticalAlign="middle"/>
		</s:HGroup>
		<s:Label  text="{data.business_name}"  color="#4d4d4d"  fontWeight="bold"
				  styleName="textsize0" verticalAlign="middle"/>
		<s:Label id="datetext"   color="#4d4d4d"  fontWeight="normal"
				  styleName="textsize0" verticalAlign="middle"/>
	</s:VGroup>		
	<s:BorderContainer bottom="0" right="0" left="20" backgroundAlpha="0" borderAlpha="0.5" 
			   borderColor="#b2b2b2" height="1.5" />
</s:Group>
</s:ItemRenderer>