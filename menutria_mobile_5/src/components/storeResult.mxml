<?xml version="1.0" encoding="utf-8"?>
<s:ItemRenderer xmlns:fx="http://ns.adobe.com/mxml/2009" 	
				xmlns:s="library://ns.adobe.com/flex/spark"
				mouseChildren="false"
				autoDrawBackground="false"
				dataChange="dchange(event)"
				creationComplete="init(event)"
				mouseOver="gOver(event);" mouseDown="gDown(event);"
				mouseOut="gOut(event);" mouseUp="gOut(event);">
	<fx:Script source="../func/global.as"/>
	<fx:Script>
		<![CDATA[
			import mx.events.FlexEvent;
			[Bindable]
			public var mainaddress:String = "";
			public var setheightval:Number = 100/(320/Capabilities.screenDPI);
			protected function init(event:FlexEvent):void
			{
				if ((data.business_picture == "None")||(data.business_picture == "")||(data.business_picture == null)||(data.business_picture == "null")){
					bmpImg.source = "assets/"+getDPIHeight().toString()+"/dish_place_wide.png";
				}
				else {
					bmpImg.source = data.business_picture;
				}
				
				bmpImg.width = setheightval*(640/300);//this.height;//-((75/(320/Capabilities.screenDPI))*data.divtype)
				bmpImg.height = setheightval;//this.height;//-((75/(320/Capabilities.screenDPI))*data.divtype);
				bmpImg.maxHeight = this.height;
				
				var maxchars:uint = 35;
				mainaddress = data.business_address1;//+', '+data.business_city;
				if (mainaddress.length > maxchars){
					mainaddress = mainaddress.substring(0,maxchars)+"...";
				}
				var ratingstring:String = data.rating.toString();
				var ratingnumber:Number = Number(data.rating);
				if (ratingnumber == 0){
					ratinglabel.text = "-";
				}
				else if (ratingnumber >= 10){
					ratingnumber = 10;
					ratinglabel.text = "10";
				}
				else {
					ratinglabel.text = ratingnumber.toPrecision(2).toString();
				}
			}
			
			public function dchange(event:FlexEvent):void
			{
				try{
					
					if ((data.business_picture == "None")||(data.business_picture == "")||(data.business_picture == null)||(data.business_picture == "null")){
						bmpImg.source = "assets/"+getDPIHeight().toString()+"/dish_place_wide.png";
					}
					else {
						bmpImg.source = data.business_picture;
					}
					
					bmpImg.width = setheightval*(640/300);//this.height;//-((75/(320/Capabilities.screenDPI))*data.divtype)
					bmpImg.height = setheightval;//this.height;//-((75/(320/Capabilities.screenDPI))*data.divtype);
					bmpImg.maxHeight = this.height;
					
					var maxchars:uint = 35;
					mainaddress = data.business_address1;//+', '+data.business_city;
					if (mainaddress.length > maxchars){
						mainaddress = mainaddress.substring(0,maxchars)+"...";
					}
					var ratingstring:String = data.rating.toString();
					var ratingnumber:Number = Number(data.rating);
					if (ratingnumber == 0){
						ratinglabel.text = "-";
					}
					else if (ratingnumber >= 10){
						ratingnumber = 10;
						ratinglabel.text = "10";
					}
					else {
						ratinglabel.text = ratingnumber.toPrecision(2).toString();
					}
				}
				catch(e:Error){}	
			}
		]]>
	</fx:Script>
	<s:Group id="megacont" width="{this.width}" mouseEnabled="false" 
			 height="{130/(320/Capabilities.screenDPI)}" >
		<s:HGroup width="{this.width-(this.height*1.3)-5}" gap="0" 
				  paddingTop="{10/(320/Capabilities.screenDPI)}"
				  paddingBottom="{10/(320/Capabilities.screenDPI)}"
				  paddingLeft="{10/(320/Capabilities.screenDPI)}"
				  verticalAlign="middle" height="90%" verticalCenter="0">
			<s:VGroup width="20%" horizontalAlign="center">
				<s:Group  height="{65/(320/Capabilities.screenDPI)}" 
						  width="{65/(320/Capabilities.screenDPI)}" 
						  horizontalCenter="0" verticalCenter="0">
					<s:Rect radiusX="{15/(320/Capabilities.screenDPI)}"
							radiusY="{15/(320/Capabilities.screenDPI)}" 
							width="100%"  height="100%">
						<s:fill>
							<s:SolidColor alpha="1" color="#b3b3b3"/>
						</s:fill>
					</s:Rect>
					<s:Label id="ratinglabel" color="#FFFFFF" 
							 horizontalCenter="0" styleName="textsize4"
							 fontWeight="bold" verticalCenter="3"/>
				</s:Group>	
				<s:HGroup>
					<s:Label color="#808080"  styleName="textsize0" 
					 text="{data.distance} km"/>
				</s:HGroup>
			</s:VGroup>
			<s:VGroup paddingLeft="{10/(320/Capabilities.screenDPI)}"  gap="10"
					paddingTop="{10/(320/Capabilities.screenDPI)}" 
					paddingBottom="{10/(320/Capabilities.screenDPI)}" 
					paddingRight="{10/(320/Capabilities.screenDPI)}">
				<s:Label width="100%" color="#4d4d4d" 
				 fontWeight="bold" styleName="textsize1" text="{data.business_name}"
				 verticalAlign="middle"></s:Label>
				<s:Label width="100%" color="#4d4d4d" 
				  styleName="textsize0" text="{data.categoryname}"
				 verticalAlign="middle"></s:Label>
				<s:Label enabled="false" width="100%" color="#43c7ae" 
				 styleName="textsize0" text="{mainaddress}"
				 verticalAlign="middle"></s:Label>
			</s:VGroup>
		</s:HGroup>
		<s:Image id="bmpImg" right="0" contentLoader="{s_imageCache}"
				 verticalCenter="0"  scaleMode="letterbox" />
		<s:Line left="{10/(320/Capabilities.screenDPI)}" right="0"  bottom="0" > 
			<s:stroke><s:SolidColorStroke color="0xb2b2b2" weight="1"/></s:stroke>
		</s:Line>
	</s:Group>
</s:ItemRenderer>