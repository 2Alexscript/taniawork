<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" xmlns:dao="dao.*" xmlns:c="components.*"
		title="{data.id>0?'Edit Expense Report':'New Expense Report'}"
		destructionPolicy="never">

	<fx:Script>
		<![CDATA[
			import model.Report;
			import com.milkmangames.nativeextensions.*;
			import com.milkmangames.nativeextensions.events.*;
			import events.ReportEvent;
			
			protected function save_clickHandler():void
			{
				data.title = reportTitle.text;
				data.description = description.text;
				data.id = srv.saveReport(data as Report);
				systemManager.dispatchEvent(new ReportEvent(ReportEvent.REPORT_SAVED, data));
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<dao:ExpenseReportDAO id="srv"/>
		<s:DateTimeFormatter id="dtf" dateTimePattern="yyyy/MM/dd"/>
	</fx:Declarations>
	
	<s:actionContent>
		<s:Button label="Save" click="save_clickHandler()"/>
	</s:actionContent>
	
	<s:layout>
		<s:VerticalLayout paddingTop="20" paddingLeft="12" paddingBottom="12" paddingRight="12" gap="24"/>
	</s:layout>
	
	<s:HGroup width="100%" verticalAlign="bottom" gap="20">

		<s:VGroup>
			<s:Label text="Date:" color="#666666"/>
			<s:DateSpinner id="dateSpinner" selectedDate="{data.date}"/>
		</s:VGroup>
		
		<s:VGroup gap="4">
			<s:HGroup verticalAlign="middle">
				<s:Label text="Title:" width="90" color="#666666"/>
				<c:MyTextInput id="reportTitle" text="{data.title}" width="350" fontSize="22"/>
			</s:HGroup>
			
			<s:HGroup verticalAlign="middle">
				<s:Label text="Description:" width="90" color="#666666"/>
				<c:MyTextInput id="description" text="{data.description}" width="350"/>
			</s:HGroup>

			<s:HGroup verticalAlign="middle">
				<s:Label text="Employee:" width="90" color="#666666"/>
				<c:MyTextInput text="Christophe Coenraets" width="350" enabled="false"/>
			</s:HGroup>
			
			<s:Spacer height="30"/>
			
			<s:HGroup verticalAlign="middle">
				<s:ToggleSwitch selected="true"/>
				<s:Label text="Fast Track Process"/>
			</s:HGroup>
			
		</s:VGroup>
		
	</s:HGroup>

	<s:BorderContainer width="100%" height="100%">
		<c:ESRIMap id="map" expenses="{srv.getExpensesByReport(data as Report)}" top="0" bottom="0" left="0" right="0"/>
	</s:BorderContainer>
	
</s:View>