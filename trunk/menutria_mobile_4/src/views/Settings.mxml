<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark"
		xmlns:components="components.*"
		backgroundColor="#f3f3f3"
		menuKeyPressed="navigator.pushView(Home)"
		backKeyPressed="navigator.popView()" 
		title="Settings" viewActivate="onActivate(event)" >
	<s:actionContent>
	</s:actionContent>
	<fx:Script source="../func/globalFunctions.as"/>
	<fx:Script source="../func/loadingfunctions.as"/>
	<fx:Script>
		<![CDATA[
			import flash.data.SQLConnection;
			import flash.data.SQLStatement;
			import flash.events.Event;
			import flash.events.MouseEvent;
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import spark.events.ViewNavigatorEvent;
			import spark.managers.PersistenceManager;
			[Bindable]
			public var catArray:ArrayCollection = new ArrayCollection();
			public function onActivate(event:Event):void
			{
				catArray =  new ArrayCollection();
				catArray.addItem({name:"Notifications", type:0, chosen:'no'});
				catArray.addItem({name:"Account", type:1, chosen:'no'});
				catArray.addItem({name:"About", type:1, chosen:'no'});
				catArray.addItem({name:"Terms of Service and Privacy", type:1, chosen:'no'});
				catArray.addItem({name:"Log Out", type:2, chosen:'no'});
				settingsList.dataProvider = catArray;
				setLoginVars();
				busy = false;
			}
			public function catListClick(ev:MouseEvent):void {
				try{
					if (settingsList.selectedItem.name == "Notifications"){
						if (settingsList.selectedItem.chosen == 'no'){
							settingsList.selectedItem.chosen == 'yes';
							catArray[0].chosen = 'yes';
						}
						else {
							settingsList.selectedItem.chosen = 'no';
							catArray[0].chosen = 'no';
						}
						
						catArray.refresh();
						settingsList.dataProvider = catArray;
					}
					else if (settingsList.selectedItem.name == "Account"){
						navigator.pushView(AccountSettings);
					}
					else if (settingsList.selectedItem.name == "About"){
						
					}
					else if (settingsList.selectedItem.name == "Terms of Service and Privacy"){
						
					}
					else if (settingsList.selectedItem.name == "Log Out"){
						logout();
					}
				}
				catch(e:Error){	
					var stop:String = "";
				}
			}
			public function logout():void {
				try{
					doQuery("delete from localuser");
					navigator.pushView(Login);
				}
				catch(e:Error){
					navigator.pushView(Login);
				}
			}
		]]>
	</fx:Script>
	<s:VGroup height="100%" horizontalCenter="0" verticalCenter="0"  width="100%"  >
		<s:List width="100%" horizontalCenter="0" height="100%" contentBackgroundAlpha="0" 
				id="settingsList" labelField="name"  
				dataProvider="{catArray}" itemRenderer="components.catResult"
				 click="catListClick(event)"  >
			<s:layout>
				<s:VerticalLayout horizontalAlign="contentJustify"   gap="0"/>
			</s:layout>
		</s:List>
	</s:VGroup>
</s:View>