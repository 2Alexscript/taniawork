<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009"
		xmlns:s="library://ns.adobe.com/flex/spark"
		xmlns:components="components.*"
		backgroundColor="#f3f3f3"
		viewActivate="init()"
		title="Settings" >
	<s:actionContent></s:actionContent>
	<fx:Script source="../func/global.as"/>
	<fx:Script>
		<![CDATA[
			import flash.events.Event;
			import flash.events.MouseEvent;
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			import spark.events.ViewNavigatorEvent;
			import spark.transitions.SlideViewTransition;
			import spark.transitions.SlideViewTransitionMode;
			import spark.transitions.ViewTransitionDirection;
			[Bindable]
			public var catArray:ArrayCollection = new ArrayCollection();
			public function init():void
			{
				
				catArray =  new ArrayCollection();
				//catArray.addItem({name:"Notifications", type:0, chosen:'no'});
				catArray.addItem({name:"Account", type:1, chosen:'no'});
				catArray.addItem({name:"About", type:1, chosen:'no'});
				catArray.addItem({name:"Terms of Service and Privacy", type:1, chosen:'no'});
				catArray.addItem({name:"Log Out", type:2, chosen:'no'});
				settingsList.dataProvider = catArray;
				setLoginVars();
			}
			public function catListClick(ev:MouseEvent):void {
				try{
					if (settingsList.selectedItem.name == "Notifications"){
						if (settingsList.selectedItem.chosen == 'no'){
							settingsList.selectedItem.chosen == 'yes';
							catArray[0].chosen = 'yes';
						}
						else {
							settingsList.selectedItem.chosen = 'no';
							catArray[0].chosen = 'no';
						}
						
						catArray.refresh();
						settingsList.dataProvider = catArray;
					}
					else if (settingsList.selectedItem.name == "Account"){
						navigator.pushView(AccountSettings);
					}
					else if (settingsList.selectedItem.name == "About"){
						navigateToURL(new URLRequest("http://groovedish.com/"));
					}
					else if (settingsList.selectedItem.name == "Terms of Service and Privacy"){
						navigateToURL(new URLRequest("http://groovedish.com/tos.php"));
					}
					else if (settingsList.selectedItem.name == "Log Out"){
						logout();
					}
				}
				catch(e:Error){	
					var stop:String = "";
				}
			}
			public function logout():void {
				
				try{
					sqlConnection = new SQLConnection();
					sqlConnection.open(File.applicationStorageDirectory.resolvePath("localuser.db"));
					var stmt:SQLStatement = new SQLStatement();
					stmt.sqlConnection = sqlConnection;
					stmt.text = "delete from localuser";
					stmt.execute();
					emailGo = "";
					nameGo = "";
					cityGo = "";
					this.parentApplication.logout();
				}
				catch(e:Error){
					emailGo = "";
					nameGo = "";
					cityGo = "";
					this.parentApplication.logout();
				}
			}
		]]>
	</fx:Script>
	<s:VGroup height="100%" horizontalCenter="0" verticalCenter="0"  width="100%"  >
		<s:List width="100%" horizontalCenter="0" height="100%" contentBackgroundAlpha="0" 
				id="settingsList" labelField="name"  
				dataProvider="{catArray}" itemRenderer="components.catResult"
				 click="catListClick(event)"  >
			<s:layout>
				<s:VerticalLayout horizontalAlign="contentJustify"   gap="0"/>
			</s:layout>
		</s:List>
	</s:VGroup>
</s:View>